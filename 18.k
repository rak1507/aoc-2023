f:{1+div[;2]@(+/y)+/1_*/(-':;+':)@'+(1+#c)#c:+\y*(0 1;1 0;0 -1;-1 0)@"RDLU"?x}.
f'(2#; +{("RDLU"@.*|x; 16/:"0123456789abcdef"?5#x:-1_2_x)}'*2_)@\:("CI*";" ")0:`:i/18.txt
