n:#i:.:''0:`:i/17.txt; dst:4#,@[9999*i=i:,/i;0;:;0]
d:(1 0;-1 0;0 1;0 -1); si:{(n/:a)*1-2*~&/n>a:x+n\:!#i}
A:+\9999^i@T:si''d*/:!11
F:{&/*|+{x&&/'&/'y+/:'9999^x[(2 3;2 3;0 1;0 1)]@/:\:'z}[;+A@x-1;+T x]/dst}
F'(1 2 3;4 5 6 7 8 9 10)
